<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–æ–Ω—Ç–∞–∫—Ç—ã</title>
<script src="https://www.google.com/recaptcha/api.js?render=explicit&onload=onRecaptchaLoad" async defer></script>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    background-color: #ffffff;
    overflow-x: hidden;
}

/* –ü–∞—Ç—Ç–µ—Ä–Ω */
body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><g fill="none" stroke="%23002f4b" stroke-width="2" stroke-opacity="0.3"><path d="M40,180 L60,160 L50,150 L40,160 Z" stroke-dasharray="2 2"/><path d="M30,50 L50,30 L40,20 L30,30 Z" stroke-dasharray="2 2"/><path d="M150,20 L170,50 L160,40 L150,50 Z" stroke-dasharray="2 2"/><path d="M80,80 L100,60 L90,50 L80,60 Z" stroke-dasharray="2 2"/><path d="M10,10 L30,40 L20,30 L10,40 Z" stroke-dasharray="2 2"/><circle cx="50" cy="150" r="5" stroke-dasharray="2 2"/><circle cx="160" cy="40" r="4" stroke-dasharray="2 2"/></g></svg>');
    background-repeat: repeat;
    background-size: 200px;
    opacity: 0.25;
    pointer-events: none;
    z-index: 0;
}

.header-text {
    max-width: 800px;
    margin: 0 auto 30px;
    text-align: center;
    position: relative;
    z-index: 1;
}
.header-text h1 {
    font-size: 24px;
    color: #2c3e50;
}
.header-text p {
    font-size: 16px;
    color: #000000;
    margin: 10px 0;
}

.feedback-form {
    max-width: 600px;
    margin-top: 30px;
    padding: 20px;
    border: 2px solid #2c3e50;
    border-radius: 12px;
    background-color: rgba(255, 255, 255, 0.9);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    position: relative;
    z-index: 1;
}

.feedback-form h2 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
}

.feedback-form p {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 16px;
}

.feedback-form label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #2c3e50;
}

.feedback-form input[type="text"],
.feedback-form input[type="email"],
.feedback-form textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #2c3e50;
    border-radius: 6px;
    font-size: 16px;
    box-sizing: border-box;
}

.feedback-form textarea {
    height: 100px;
    resize: vertical;
}

.feedback-form #recaptcha-container {
    margin-bottom: 15px;
    text-align: center;
}

.feedback-form button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    background-color: #2c3e50;
    color: white;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s;
}

.feedback-form button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}

.feedback-form button:not(:disabled):hover {
    background-color: #34495e;
}

.top-menu {
    position: fixed;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 10px;
    z-index: 10;
}

.top-menu button {
    padding: 12px 16px;
    border-radius: 12px;
    border: 2px solid #2c3e50;
    background-color: #2c3e50;
    color: white;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    transition: background-color 0.3s;
}

.top-menu button:hover {
    background-color: #34495e;
}

/* –ê–¥–∞–ø—Ç–∏–≤ */
@media screen and (max-width: 768px) {
    body {
        padding-top: 60px;
    }
    .feedback-form {
        width: 90%;
        padding: 15px;
    }
    .top-menu {
        top: 5px;
        right: 5px;
    }
    .top-menu button {
        padding: 10px 12px;
        font-size: 14px;
    }
}
</style>
</head>
<body>
    <div class="top-menu">
        <button onclick="App.navigate('index.html')" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é">üè†</button>
    </div>

    <div class="header-text">
        <h1>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
        <p>¬© 2025 Geocalculator. –ì–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã –æ–Ω–ª–∞–π–Ω</p>
        <br>
        <p> –í—ã –º–æ–∂–µ—Ç–µ 
            <a href="https://t.me/GeocalculatorOnline_Bot" target="_blank" style="color:#229ED9;text-decoration:none">–ù–∞–ø–∏—Å–∞—Ç—å –Ω–∞–º –≤ Telegram
                <svg width="14" height="14" viewBox="0 0 240 240" style="vertical-align:-2px;fill:currentColor">
                    <path d="M120 0C53.7 0 0 53.7 0 120s53.7 120 120 120 120-53.7 120-120S186.3 0 120 0zm58.1 82.6-20.2 95.3c-1.5 6.7-5.5 8.3-11.1 5.2l-30.7-22.6-14.8 14.3c-1.6 1.6-3 3-6.2 3l2.2-31.6 57.5-52c2.5-2.2-.5-3.4-3.9-1.2l-71 44.7-30.6-9.6c-6.6-2-6.7-6.6 1.4-9.8l119.5-46.1c5.5-2 10.3 1.3 8.9 9.4z"/>
                </svg>
            </a>–∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ–æ—Ä–º–æ–π –Ω–∏–∂–µ!
    </div>
    <div class="feedback-form">
        <h2>–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏</h2>
        <p>–û—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ –º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–º!</p>
        <form action="https://formspree.io/f/xdkwdver" method="POST" id="contact-form">
            <input type="hidden" name="_subject" value="–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–∞–π—Ç–∞ Geocalculator">
            <input type="hidden" name="_next" value="https://geocalculator.ru/thanks.html?status=success">
            
            <label for="name">–ò–º—è:</label>
            <input type="text" id="name" name="name" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
            
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email">
            
            <label for="message">–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
            <textarea id="message" name="message" required placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"></textarea>
            
            <div id="recaptcha-container" data-sitekey="6LdmhOArAAAAAPKfVrQKb2gK485gry3lJYPFgcQL" data-callback="onRecaptchaSuccess"></div>
            
            <button type="submit" id="submit-button" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
        </form>
    </div>

    <script>
        const App = {
            toggleMenu() {
                document.getElementById("sidebar").classList.toggle("open");
            },
            navigate(url) {
                location.href = url;
            }
        };

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ reCAPTCHA
        function onRecaptchaLoad() {
            console.log('reCAPTCHA loaded successfully');
            const container = document.getElementById('recaptcha-container');
            if (container) {
                grecaptcha.render(container, {
                    'sitekey': '6LdmhOArAAAAAPKfVrQKb2gK485gry3lJYPFgcQL',
                    'callback': onRecaptchaSuccess
                });
                console.log('reCAPTCHA rendered');
            } else {
                console.error('reCAPTCHA container not found');
            }
        }

        // –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ reCAPTCHA
        function onRecaptchaSuccess(token) {
            console.log('reCAPTCHA success, token:', token);
            document.getElementById('submit-button').disabled = false;
            const form = document.getElementById('contact-form');
            let tokenInput = form.querySelector('input[name="g-recaptcha-response"]');
            if (!tokenInput) {
                tokenInput = document.createElement('input');
                tokenInput.type = 'hidden';
                tokenInput.name = 'g-recaptcha-response';
                form.appendChild(tokenInput);
            }
            tokenInput.value = token;
            console.log('reCAPTCHA token added to form:', token);
        }

        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('contact-form').addEventListener('submit', async function(event) {
            event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
            const form = this;
            const formData = new FormData(form);

            try {
                console.log('Sending form to Formspree with data:', [...formData]);
                const response = await fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    },
                    redirect: 'manual' // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º HTTP-—Ä–µ–¥–∏—Ä–µ–∫—Ç—ã
                });

                console.log('Formspree response status:', response.status);
                const responseBody = await response.text();
                console.log('Formspree response body:', responseBody);

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ—à–∏–±–∫–∏ –≤ JSON
                let responseJson = {};
                try {
                    responseJson = JSON.parse(responseBody);
                } catch (e) {
                    console.log('Response is not JSON');
                }

                if (response.ok && (!responseJson.errors || responseJson.errors.length === 0)) {
                    console.log('Redirecting to success page');
                    window.location.href = 'https://geocalculator.ru/thanks.html?status=success';
                } else {
                    console.log('Redirecting to error page due to status or errors:', response.status, responseJson.errors || 'No errors in JSON');
                    window.location.href = 'https://geocalculator.ru/thanks.html?status=error';
                }
            } catch (error) {
                console.error('Form submission error:', error.message);
                window.location.href = 'https://geocalculator.ru/thanks.html?status=error';
            }
        });
    </script>
</body>
</html>